AB分区位置无关的hash功能验证流程介绍
-----------------------------------------

:link_to_translation:`en:[English]`

通过hash算法来保证下载数据的完整性，hash功能验证流程分为以下两个步骤：

- 1.去获取升级固件中的rbl的head信息（rbl信息存放位于升级固件的最后4k位置）；
- 2.然后通过hash256 算法计算整个固件的hash值，然后和rbl中存放的hash值作比较，若两个hash数值一样，则代表hash通过，固件完整，否则，下载数据不全；
- 3.以分区A升级分区B为例：

  - 1.1）当A下载B完成之后，reboot跳转到bootloader中，先获取升级固件B中rbl信息；
  - 1.2）然后通过hash256算法，计算升级B的hash值，若该hash值等于rbl中hash值，则代表升级B数据完整，然后设置flash相关控制寄存器的bit[0] = 1;则直接跳转到B分区执行；
  - 1.3）若通过hash256算法，计算得到hash值与rbl中hash值不一致，则删除B分区的数据，然后设置flash相关控制寄存器的bit[0] = 0;然后继续执行A分区。

